/*
 * =============================================================================
 *
 *       Filename:  protocol_singlechip.c
 *
 *    Description:  单片机通信协议
 *
 *        Version:  1.0
 *        Created:  2019-06-10 13:11:39
 *       Revision:  none
 *
 *         Author:  xubin
 *        Company:  Taichuan
 *
 * =============================================================================
 */
/* ---------------------------------------------------------------------------*
 *                      include head files
 *----------------------------------------------------------------------------*/
#include <stdio.h>
#include <stdint.h>
#include "debug.h"
#include "uart.h"

/* ---------------------------------------------------------------------------*
 *                  extern variables declare
 *----------------------------------------------------------------------------*/

/* ---------------------------------------------------------------------------*
 *                  internal functions declare
 *----------------------------------------------------------------------------*/

/* ---------------------------------------------------------------------------*
 *                        macro define
 *----------------------------------------------------------------------------*/

/* ---------------------------------------------------------------------------*
 *                      variables define
 *----------------------------------------------------------------------------*/
static char send_buf[] = {0x5A, 0x06, 0x01, 0x41, 0x48,0x5B};
static void uartDeal(void)
{
	unsigned char buff[1024]={0};

	int len = uart->recvBuffer(uart,buff,sizeof(buff));
	if (len <= 0) {
		return;
	}
	int i;
	DPRINT("[uart-->reci,%d]",len );
	for (i=0; i<len; i++) {
		DPRINT("%02X " ,buff[i] );
	}
	DPRINT("\n" );
}

void registSingleChip(void)
{
#ifdef USE_UART
	uartInit(uartDeal);
	if (uart)
		uart->send(uart,send_buf,6);
#endif
}
